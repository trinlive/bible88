<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà | Biblical Calendar</title>
    
    <link rel="stylesheet" href="css/style.css?v=12">
</head>
<body>

<nav class="top-navbar">
    <div class="logo-area">üóìÔ∏è ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏û‡∏£‡∏∞‡∏Ñ‡∏±‡∏°‡∏†‡∏µ‡∏£‡πå</div>
    
    <div class="nav-menu">
        <div id="moonPhaseWidget"></div>

        <a href="calendar.html" class="nav-item">üìÖ ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏£‡∏≤‡∏¢‡∏õ‡∏µ</a>
        <a href="converter.html" class="nav-item active">üîÑ ‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</a> <a href="index.html" class="nav-item" style="color:#e74c3c;">‚¨Ö ‡∏≠‡∏≠‡∏Å</a>
    </div>
</nav>

<div class="main-content">

    <div class="converter-wrapper">
        <h2 style="color:#2c3e50; margin-bottom:10px;">üîÑ ‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏Å‡∏•</h2>
        <p style="color:#7f8c8d; margin-bottom:30px;">‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Æ‡∏µ‡∏ö‡∏£‡∏π (True Lunar / Enoch)</p>

        <div class="date-input-group">
            <input type="date" id="gregorianDate" class="date-input">
        </div>

        <button onclick="convertDate()" class="btn-convert">‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</button>

        <div id="resultCard" class="result-card">
            <div style="font-size:0.9em; color:#7f8c8d;">‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</div>
            <div id="hebrewDateResult" class="result-date">-</div>
            <div id="hebrewMonthResult" style="color:#34495e; font-size:1.1em;">-</div>
            <div id="dayNameResult" style="margin-top:10px; color:#27ae60; font-weight:bold;">-</div>
            
            <div id="eventResult" style="margin-top:15px; padding-top:15px; border-top:1px dashed #ddd; font-size:0.95em; color:#d35400;"></div>
        </div>
    </div>

</div>

<script>
    // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Default ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÉ‡∏ô Input
    document.addEventListener('DOMContentLoaded', () => {
        const dateInput = document.getElementById('gregorianDate');
        if(dateInput) {
            dateInput.value = new Date().toISOString().split('T')[0];
        }
    });

    function convertDate() {
        const input = document.getElementById('gregorianDate').value;
        if(!input) return;

        const resultCard = document.getElementById('resultCard');
        const hDate = document.getElementById('hebrewDateResult');
        const hMonth = document.getElementById('hebrewMonthResult');
        const dName = document.getElementById('dayNameResult');
        const evtRes = document.getElementById('eventResult');

        // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î
        resultCard.style.display = 'block';
        hDate.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì...';
        hMonth.textContent = '';
        dName.textContent = '';
        evtRes.textContent = '';

        // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Backend (‡∏õ‡∏£‡∏±‡∏ö URL ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì)
        fetch(`/api/convert?date=${input}`)
            .then(res => res.json())
            .then(data => {
                // ‡∏™‡∏°‡∏°‡∏ï‡∏¥ data ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô { day: 1, monthName: "Abib", dayName: "Monday", event: "New Moon" }
                if(data.error) {
                    hDate.textContent = "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
                    return;
                }

                hDate.textContent = `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${data.lunar.day}`;
                hMonth.textContent = `‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${data.lunar.monthName}`;
                dName.textContent = data.dayName; // ‡∏ß‡∏±‡∏ô‡πÉ‡∏ô‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå
                
                if(data.lunar.phase || data.lunar.history) {
                     const phase = data.lunar.phase || "";
                     const hist = data.lunar.history ? data.lunar.history.join(", ") : "";
                     evtRes.innerHTML = `<strong>${phase}</strong><br>${hist}`;
                } else {
                    evtRes.textContent = "- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏û‡∏¥‡πÄ‡∏®‡∏© -";
                }
            })
            .catch(err => {
                console.error(err);
                hDate.textContent = "‚ö†Ô∏è ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î";
            });
    }
</script>
<script src="js/moonPhase.js?v=4"></script>

</body>
</html>